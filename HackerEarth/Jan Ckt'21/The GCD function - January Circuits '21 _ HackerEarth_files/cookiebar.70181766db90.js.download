/*
 * Copyright (C) 2012 PrimeBox
 *
 * This work is licensed under the Creative Commons
 * Attribution 3.0 Unported License. To view a copy
 * of this license, visit
 * http://creativecommons.org/licenses/by/3.0/.
 *
 * Documentation available at:
 * http://www.primebox.co.uk/projects/cookie-bar/
 *
 * When using this software you use it at your own risk. We hold
 * no responsibility for any damage caused by using this plugin
 * or the documentation provided.
 */(function(a){a.cookieBar=function(b,c){var d;b==="cookies"?d="cookies":b==="set"?d="set":d=!1;var e={message:COOKIE_BAR_MESSAGE,acceptButton:!0,acceptText:COOKIE_BAR_ACCEPT_TEXT,acceptFunction:function(a){a!=="enabled"&&a!=="accepted"&&(window.location=window.location.href)},declineButton:!1,declineText:COOKIE_BAR_DECLINE_TEXT,declineFunction:function(a){if(a==="enabled"||a==="accepted")window.location=window.location.href},policyButton:!0,policyText:COOKIE_BAR_POLICY_TEXT,policyURL:"http://www.hackerearth.com/privacy/",autoEnable:!0,acceptOnContinue:!1,acceptOnScroll:!1,acceptAnyClick:!1,expireDays:365,renewOnVisit:!1,forceShow:!1,effect:"slide",element:"body",append:!1,fixed:!0,bottom:!0,zindex:"10",domain:String(window.location.hostname),referrer:String(document.referrer)};b=a.extend(e,b);var f=new Date;f.setTime(f.getTime()+b.expireDays*864e5),f=f.toGMTString();var g="cb-enabled={value}; expires="+f+"; path=/",h,i="",j,k=document.cookie.split("; ");for(h=0;h<k.length;h++)j=k[h].split("="),j[0]==="cb-enabled"&&(i=j[1]);i===""&&d!=="cookies"&&b.autoEnable?(i="enabled",document.cookie=g.replace("{value}","enabled")):(i==="accepted"||i==="declined")&&d!=="cookies"&&b.renewOnVisit&&(document.cookie=g.replace("{value}",i)),b.acceptOnContinue&&b.referrer.indexOf(b.domain)>=0&&String(window.location.href).indexOf(b.policyURL)===-1&&d!=="cookies"&&d!=="set"&&i!=="accepted"&&i!=="declined"&&(d="set",c="accepted");if(d==="cookies")return i==="enabled"||i==="accepted"?!0:!1;if(d==="set"&&(c==="accepted"||c==="declined"))return document.cookie=g.replace("{value}",c),c==="accepted"?!0:!1;var l=b.message.replace("{policy_url}",b.policyURL),m;b.acceptButton?m='<a href="" class="cb-enable">'+b.acceptText+"</a>":m="";var n;b.declineButton?n='<a href="" class="cb-disable">'+b.declineText+"</a>":n="";var o;b.policyButton?o='<a href="'+b.policyURL+'" class="cb-policy">'+b.policyText+"</a>":o="";var p;b.fixed?b.bottom?p=' class="fixed bottom"':p=' class="fixed"':p="";var q;b.zindex!==""?q=' style="z-index:'+b.zindex+';"':q="";if(b.forceShow||i==="enabled"||i==="")b.append?a(b.element).append('<div id="cookie-bar"'+p+q+"><p>"+l+m+n+o+"</p></div>"):a(b.element).prepend('<div id="cookie-bar"'+p+q+"><p>"+l+m+n+o+"</p></div>");var r=function(c){b.acceptOnScroll&&a(document).off("scroll"),typeof c=="function"&&c(i),b.effect==="slide"?a("#cookie-bar").slideUp(300,function(){a("#cookie-bar").remove()}):b.effect==="fade"?a("#cookie-bar").fadeOut(300,function(){a("#cookie-bar").remove()}):a("#cookie-bar").hide(0,function(){a("#cookie-bar").remove()}),a(document).unbind("click",u)},s=function(){document.cookie=g.replace("{value}","accepted"),r(b.acceptFunction)},t=function(){var a=new Date;a.setTime(a.getTime()-864e6),a=a.toGMTString(),k=document.cookie.split("; ");for(h=0;h<k.length;h++)j=k[h].split("="),j[0].indexOf("_")>=0?document.cookie=j[0]+"=0; expires="+a+"; domain="+b.domain.replace("www","")+"; path=/":document.cookie=j[0]+"=0; expires="+a+"; path=/";document.cookie=g.replace("{value}","declined"),r(b.declineFunction)},u=function(b){a(b.target).hasClass("cb-policy")||s()};a("#cookie-bar .cb-enable").click(function(){return s(),!1}),a("#cookie-bar .cb-disable").click(function(){return t(),!1});if(b.acceptOnScroll){var v=a(document).scrollTop(),w,x;a(document).on("scroll",function(){w=a(document).scrollTop(),w>v?x=w-v:x=v-w,x>=Math.round(b.acceptOnScroll)&&s()})}b.acceptAnyClick&&a(document).bind("click",u)}})(jQuery);